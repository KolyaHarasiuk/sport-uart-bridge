# S-Port to UART Bridge –¥–ª—è FPV

> **‚ö†Ô∏è TEST –ì–Ü–õ–ö–ê** - –í–µ—Ä—Å—ñ—è –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è–º —à–≤–∏–¥–∫–æ—Å—Ç—ñ (400k/115200)  
> –î–ª—è —Å—Ç–∞–±—ñ–ª—å–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ —Ñ—ñ–∫—Å–æ–≤–∞–Ω–∏–º 400k –¥–∏–≤–∏—Å—å –≥—ñ–ª–∫—É `main`

–ö–æ–Ω–≤–µ—Ä—Ç–æ—Ä S-Port (—ñ–Ω–≤–µ—Ä—Ç–æ–≤–∞–Ω–∏–π, half-duplex) ‚Üî UART (–Ω–æ—Ä–º–∞–ª—å–Ω–∏–π, full-duplex) –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ —Ç–µ–ª–µ–º–µ—Ç—Ä—ñ—ó —á–µ—Ä–µ–∑ –æ–ø—Ç–æ–≤–æ–ª–æ–∫–Ω–æ.

## –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è

–î–æ–∑–≤–æ–ª—è—î –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ S-Port —Ç–µ–ª–µ–º–µ—Ç—Ä—ñ—é –∑ –∞–ø–∞—Ä–∞—Ç—É—Ä–∏ FPV –≤ –∑–æ–≤–Ω—ñ—à–Ω—ñ–π ELRS –º–æ–¥—É–ª—å —á–µ—Ä–µ–∑ –º–µ–¥—ñ–∞–∫–æ–Ω–≤–µ—Ä—Ç–æ—Ä —ñ –æ–ø—Ç–æ–≤–æ–ª–æ–∫–Ω–æ, –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ —Ä–æ–±–æ—Ç—É Lua —Å–∫—Ä–∏–ø—Ç—ñ–≤.

## –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è

### ESP32 #1 (–±—ñ–ª—è –∞–ø–∞—Ä–∞—Ç—É—Ä–∏)
```
–ê–ø–∞—Ä–∞—Ç—É—Ä–∞ S-Port ‚îÄ‚îÄ‚îÄ> GPIO 10 (half-duplex, —ñ–Ω–≤–µ—Ä—Ç–æ–≤–∞–Ω–∏–π)
–ú–µ–¥—ñ–∞–∫–æ–Ω–≤–µ—Ä—Ç–æ—Ä TX ‚îÄ‚îÄ> GPIO 16 (RX)
–ú–µ–¥—ñ–∞–∫–æ–Ω–≤–µ—Ä—Ç–æ—Ä RX <‚îÄ‚îÄ GPIO 17 (TX)
GND ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ> GND
5V ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ> VIN –∞–±–æ 5V
```

### ESP32 #2 (–±—ñ–ª—è ELRS –º–æ–¥—É–ª—è)
```
–ú–µ–¥—ñ–∞–∫–æ–Ω–≤–µ—Ä—Ç–æ—Ä TX ‚îÄ‚îÄ> GPIO 16 (RX)
–ú–µ–¥—ñ–∞–∫–æ–Ω–≤–µ—Ä—Ç–æ—Ä RX <‚îÄ‚îÄ GPIO 17 (TX)
ELRS –º–æ–¥—É–ª—å S-Port <‚îÄ> GPIO 10 (half-duplex, —ñ–Ω–≤–µ—Ä—Ç–æ–≤–∞–Ω–∏–π)
GND ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ> GND
5V ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ> VIN –∞–±–æ 5V
```

## –¢–µ—Ö–Ω—ñ—á–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏

- **S-Port —à–≤–∏–¥–∫–æ—Å—Ç—ñ:** 400000 –∞–±–æ 115200 baud (–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è)
- **UART —à–≤–∏–¥–∫—ñ—Å—Ç—å:** —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—î—Ç—å—Å—è –∑ S-Port
- **S-Port —Ñ–æ—Ä–º–∞—Ç:** 8N1, —ñ–Ω–≤–µ—Ä—Ç–æ–≤–∞–Ω–∏–π, half-duplex
- **UART —Ñ–æ—Ä–º–∞—Ç:** 8N1, –Ω–æ—Ä–º–∞–ª—å–Ω–∏–π, full-duplex

### Auto-Baud Detection

–ü—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ ESP32 –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∑–Ω–∞—á–∞—î —à–≤–∏–¥–∫—ñ—Å—Ç—å S-Port:
1. –°–ø–æ—á–∞—Ç–∫—É –ø—Ä–æ–±—É—î **400000 baud** (FrSky high-speed)
2. –Ø–∫—â–æ –ø—Ä–æ—Ç—è–≥–æ–º 2 —Å–µ–∫—É–Ω–¥ –Ω–µ–º–∞—î –¥–∞–Ω–∏—Ö ‚Üí –ø–µ—Ä–µ–º–∏–∫–∞—î—Ç—å—Å—è –Ω–∞ **115200 baud**
3. –®–≤–∏–¥–∫—ñ—Å—Ç—å –º–µ–¥—ñ–∞–∫–æ–Ω–≤–µ—Ä—Ç–æ—Ä–∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—î—Ç—å—Å—è –∑ –≤–∏—è–≤–ª–µ–Ω–æ—é —à–≤–∏–¥–∫—ñ—Å—Ç—é S-Port

–¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –æ–¥–Ω–∞ —ñ —Ç–∞ –∂ –ø—Ä–æ—à–∏–≤–∫–∞ –ø—Ä–∞—Ü—é—î –∑ —Ä—ñ–∑–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏:
- **FrSky ACCESS** (400k baud)
- **FrSky D16/D8** (115200 baud)
- **–Ü–Ω—à—ñ —Å–∏—Å—Ç–µ–º–∏** –∑ S-Port

## –ì—ñ–ª–∫–∏ –ø—Ä–æ—î–∫—Ç—É

### üî¨ `test` (–ø–æ—Ç–æ—á–Ω–∞ –≥—ñ–ª–∫–∞)
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ S-Port
- ‚úÖ –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ 400k —Ç–∞ 115200 baud
- ‚úÖ –£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∞ –ø—Ä–æ—à–∏–≤–∫–∞ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Å–∏—Å—Ç–µ–º
- ‚ö†Ô∏è –î–µ—Ç–µ–∫—Ü—ñ—è –∑–∞–π–º–∞—î ~4 —Å–µ–∫—É–Ω–¥–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç—ñ
- ‚ö†Ô∏è –¢–µ—Å—Ç–æ–≤–∞ –≤–µ—Ä—Å—ñ—è, –º–æ–∂–ª–∏–≤—ñ –±–∞–≥–∏

### üîí `main` (—Å—Ç–∞–±—ñ–ª—å–Ω–∞)
- ‚úÖ –§—ñ–∫—Å–æ–≤–∞–Ω–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å 400k baud
- ‚úÖ –ú–∏—Ç—Ç—î–≤–∏–π —Å—Ç–∞—Ä—Ç, –±–µ–∑ –¥–µ—Ç–µ–∫—Ü—ñ—ó
- ‚úÖ –ü–µ—Ä–µ–≤—ñ—Ä–µ–Ω–∞ —Ç–∞ —Å—Ç–∞–±—ñ–ª—å–Ω–∞
- ‚ùå –ü—Ä–∞—Ü—é—î —Ç—ñ–ª—å–∫–∏ –∑ ACCESS (400k)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π `main` —è–∫—â–æ —É —Ç–µ–±–µ —Ç—ñ–ª—å–∫–∏ ACCESS. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π `test` —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–∞ —É–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω—ñ—Å—Ç—å.

## –ü—Ä–æ—à–∏–≤–∫–∞

### –ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –º—ñ–∂ –≥—ñ–ª–∫–∞–º–∏

**–î–ª—è —Ç–µ—Å—Ç–æ–≤–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ –∞–≤—Ç–æ–¥–µ—Ç–µ–∫—Ç–æ–º:**
```bash
git checkout test
pio run -t upload
```

**–î–ª—è —Å—Ç–∞–±—ñ–ª—å–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó (—Ç—ñ–ª—å–∫–∏ 400k):**
```bash
git checkout main
pio run -t upload
```

### –î–ª—è ESP32 DevKit V1:
```bash
pio run -e esp32dev -t upload
```

### –î–ª—è ESP32-C3 SuperMini:
1. –†–æ–∑–∫–æ–º–µ–Ω—Ç—É–π —Å–µ–∫—Ü—ñ—é `[env:esp32-c3-devkitm-1]` –≤ `platformio.ini`
2. –ó–∞–∫–æ–º–µ–Ω—Ç—É–π —Å–µ–∫—Ü—ñ—é `[env:esp32dev]`
3. –ü—Ä–æ—à–∏–≤–∞–π:
```bash
pio run -e esp32-c3-devkitm-1 -t upload
```

## –î–µ–±–∞–≥

–ü—ñ–¥–∫–ª—é—á–∏ Serial Monitor (115200 baud) —â–æ–± –±–∞—á–∏—Ç–∏ –ª–æ–≥–∏:
```bash
pio device monitor
```

–†–æ–∑–∫–æ–º–µ–Ω—Ç—É–π —Ä—è–¥–∫–∏ –∑ `Serial.printf()` –≤ –∫–æ–¥—ñ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥—É–≤–∞–Ω–Ω—è —Ç—Ä–∞—Ñ—ñ–∫—É.

## –í–∞–∂–ª–∏–≤–æ!

- **–û–¥–Ω–∞ –ø—Ä–æ—à–∏–≤–∫–∞** –ø—Ä–∞—Ü—é—î –Ω–∞ –æ–±–æ—Ö ESP32 (–±—ñ–ª—è –∞–ø–∞—Ä–∞—Ç—É—Ä–∏ —ñ –±—ñ–ª—è ELRS)
- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Ä—ñ–∑–Ω—ñ, –∞–ª–µ –ª–æ–≥—ñ–∫–∞ –æ–¥–Ω–∞–∫–æ–≤–∞
- –ë–µ–∑ –∂–æ–¥–Ω–∏—Ö —Ä–µ–∑–∏—Å—Ç–æ—Ä—ñ–≤ - —ñ–Ω–≤–µ—Ä—Å—ñ—è —ñ half-duplex –≤ –∫–æ–¥—ñ
- GPIO 10 –ø—Ä–∞—Ü—é—î —è–∫ –æ–¥–∏–Ω –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π –ø—ñ–Ω –¥–ª—è S-Port

### –î–ª—è test –≥—ñ–ª–∫–∏:
- ‚ö†Ô∏è –ü–µ—Ä—à–µ –≤–º–∏–∫–∞–Ω–Ω—è –∑–∞–π–º–µ ~4 —Å–µ–∫—É–Ω–¥–∏ (–∞–≤—Ç–æ–¥–µ—Ç–µ–∫—Ç —à–≤–∏–¥–∫–æ—Å—Ç—ñ)
- ‚ö†Ô∏è –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è —â–æ –æ–±–∏–¥–≤—ñ ESP32 –≤–∏–∑–Ω–∞—á–∏–ª–∏ –æ–¥–Ω–∞–∫–æ–≤—É —à–≤–∏–¥–∫—ñ—Å—Ç—å
- ‚ö†Ô∏è –î–∏–≤–∏—Å—å Serial Monitor (115200) —â–æ–± –±–∞—á–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–µ—Ç–µ–∫—Ü—ñ—ó
- ‚ö†Ô∏è –Ø–∫—â–æ –≤–∏–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º–∏ - –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π —Å—Ç–∞–±—ñ–ª—å–Ω—É –≥—ñ–ª–∫—É `main`

## –ü—Ä–∏–º—ñ—Ç–∫–∏

- –Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—à ESP32-C3, –ø—ñ–Ω–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ —ñ–Ω—à–∏–º–∏. –ü–µ—Ä–µ–≤—ñ—Ä –¥–∞—Ç–∞—à–∏—Ç —Ç–≤–æ—î—ó –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó –ø–ª–∞—Ç–∏.
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø—ñ–Ω–∏ UART1 —ñ UART2 –º–æ–∂—É—Ç—å –≤—ñ–¥—Ä—ñ–∑–Ω—è—Ç–∏—Å—è –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö –ø–ª–∞—Ç–∞—Ö ESP32
- –î–ª—è ESP32-C3 SuperMini –ø–µ—Ä–µ–≤—ñ—Ä —è–∫—ñ –ø—ñ–Ω–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ –Ω–∞ —Ç–≤–æ—ó–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ–π –ø–ª–∞—Ç—ñ

## Troubleshooting

**Auto-baud –Ω–µ –≤–∏–∑–Ω–∞—á–∞—î —à–≤–∏–¥–∫—ñ—Å—Ç—å:**
- –ü–µ—Ä–µ–≤—ñ—Ä —â–æ –∞–ø–∞—Ä–∞—Ç—É—Ä–∞ –≤–∫–ª—é—á–µ–Ω–∞ —ñ –ø–µ—Ä–µ–¥–∞—î —Ç–µ–ª–µ–º–µ—Ç—Ä—ñ—é
- –ü–æ–¥–∏–≤–∏—Å—å Serial Monitor - —Ç–∞–º –±—É–¥–µ –≤–∏–¥–Ω–æ —â–æ —Å–∞–º–µ –¥–µ—Ç–µ–∫—Ç–∏—Ç—å—Å—è
- –î–µ—Ç–µ–∫—Ü—ñ—è –∑–∞–π–º–∞—î ~4 —Å–µ–∫—É–Ω–¥–∏ (–ø–æ 2 —Å–µ–∫ –Ω–∞ –∫–æ–∂–Ω—É —à–≤–∏–¥–∫—ñ—Å—Ç—å)
- ESP32 –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –≤–∏–±–µ—Ä–µ 400k —è–∫—â–æ –Ω—ñ—á–æ–≥–æ –Ω–µ –≤–∏—è–≤–ª–µ–Ω–æ

**–ù–µ –ø—Ä–∞—Ü—é—î S-Port:**
- –ü–µ—Ä–µ–≤—ñ—Ä —â–æ –ø—ñ–Ω GPIO 10 —Ñ—ñ–∑–∏—á–Ω–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏–π
- –ü–µ—Ä–µ–≤—ñ—Ä –ø–æ–ª—è—Ä–Ω—ñ—Å—Ç—å (S-Port = Signal, –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä —á–∏ –Ω–µ –ø–µ—Ä–µ–ø–ª—É—Ç–∞–≤ –∑ GND)
- –ü–æ–¥–∏–≤–∏—Å—å –≤ Serial Monitor —á–∏ —î —è–∫–∏–π—Å—å —Ç—Ä–∞—Ñ—ñ–∫ —ñ —è–∫—É —à–≤–∏–¥–∫—ñ—Å—Ç—å –≤–∏–∑–Ω–∞—á–∏–ª–æ

**–ù–µ –ø—Ä–∞—Ü—é—î —á–µ—Ä–µ–∑ –æ–ø—Ç–∏–∫—É:**
- –ü–µ—Ä–µ–≤—ñ—Ä —â–æ –º–µ–¥—ñ–∞–∫–æ–Ω–≤–µ—Ä—Ç–æ—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∂–∏–≤–ª—è—Ç—å—Å—è
- –ü–µ—Ä–µ–≤—ñ—Ä —â–æ TX –æ–¥–Ω–æ–≥–æ –π–¥–µ –≤ RX —ñ–Ω—à–æ–≥–æ
- **–í–∞–∂–ª–∏–≤–æ:** –û–±–∏–¥–≤—ñ ESP32 –º–∞—é—Ç—å –≤–∏–∑–Ω–∞—á–∏—Ç–∏ –æ–¥–Ω–∞–∫–æ–≤—É —à–≤–∏–¥–∫—ñ—Å—Ç—å! –î–∏–≤–∏—Å—å Serial Monitor –Ω–∞ –æ–±–æ—Ö

**Lua —Å–∫—Ä–∏–ø—Ç–∏ –Ω–µ –±–∞—á–∞—Ç—å –º–æ–¥—É–ª—å:**
- –ü–µ—Ä–µ–≤—ñ—Ä —â–æ ELRS –º–æ–¥—É–ª—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–∏–π –¥–æ GPIO 10
- –ü–µ—Ä–µ–≤—ñ—Ä —â–æ –≤ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è—Ö ELRS –≤–∫–ª—é—á–µ–Ω–æ —Ç–µ–ª–µ–º–µ—Ç—Ä—ñ—é
- –°–ø—Ä–æ–±—É–π –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∞–ø–∞—Ä–∞—Ç—É—Ä—É
- –ü–µ—Ä–µ–≤—ñ—Ä —â–æ ESP32 –≤–∏–∑–Ω–∞—á–∏–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—É —à–≤–∏–¥–∫—ñ—Å—Ç—å (400k –¥–ª—è ACCESS)

## –õ—ñ—Ü–µ–Ω–∑—ñ—è

–ö–æ–¥ –≤—ñ–ª—å–Ω–∏–π, —Ä–æ–±–∏ —â–æ —Ö–æ—á–µ—à ü§ò